"use strict";var cov_1bxotiz5jl=function(){var path="/home/jivago/vscode/tscurso/build/tests/integration/integration.js",hash="9dfa630be39d0b8b65fedcd5144cc9f44ef9b736",global=new Function('return this')(),gcv="__coverage__",coverageData={path:"/home/jivago/vscode/tscurso/build/tests/integration/integration.js",statementMap:{"0":{start:{line:2,column:0},end:{line:2,column:62}},"1":{start:{line:3,column:17},end:{line:3,column:39}},"2":{start:{line:4,column:10},end:{line:4,column:31}},"3":{start:{line:5,column:16},end:{line:5,column:43}},"4":{start:{line:6,column:0},end:{line:150,column:3}},"5":{start:{line:8,column:17},end:{line:8,column:60}},"6":{start:{line:9,column:16},end:{line:9,column:46}},"7":{start:{line:12,column:19},end:{line:17,column:5}},"8":{start:{line:18,column:22},end:{line:23,column:5}},"9":{start:{line:24,column:4},end:{line:36,column:7}},"10":{start:{line:25,column:8},end:{line:35,column:11}},"11":{start:{line:28,column:12},end:{line:28,column:50}},"12":{start:{line:30,column:12},end:{line:34,column:15}},"13":{start:{line:32,column:16},end:{line:32,column:67}},"14":{start:{line:33,column:16},end:{line:33,column:23}},"15":{start:{line:37,column:4},end:{line:66,column:7}},"16":{start:{line:38,column:8},end:{line:51,column:11}},"17":{start:{line:39,column:30},end:{line:42,column:13}},"18":{start:{line:43,column:12},end:{line:50,column:15}},"19":{start:{line:47,column:16},end:{line:47,column:69}},"20":{start:{line:48,column:16},end:{line:48,column:70}},"21":{start:{line:49,column:16},end:{line:49,column:28}},"22":{start:{line:52,column:8},end:{line:65,column:11}},"23":{start:{line:53,column:30},end:{line:56,column:13}},"24":{start:{line:57,column:12},end:{line:64,column:15}},"25":{start:{line:61,column:16},end:{line:61,column:79}},"26":{start:{line:62,column:16},end:{line:62,column:52}},"27":{start:{line:63,column:16},end:{line:63,column:28}},"28":{start:{line:67,column:4},end:{line:81,column:7}},"29":{start:{line:68,column:8},end:{line:80,column:11}},"30":{start:{line:69,column:12},end:{line:79,column:15}},"31":{start:{line:74,column:16},end:{line:74,column:69}},"32":{start:{line:75,column:16},end:{line:75,column:69}},"33":{start:{line:76,column:16},end:{line:76,column:89}},"34":{start:{line:77,column:16},end:{line:77,column:91}},"35":{start:{line:78,column:16},end:{line:78,column:28}},"36":{start:{line:82,column:4},end:{line:96,column:7}},"37":{start:{line:83,column:8},end:{line:95,column:11}},"38":{start:{line:84,column:12},end:{line:94,column:15}},"39":{start:{line:89,column:16},end:{line:89,column:69}},"40":{start:{line:90,column:16},end:{line:90,column:79}},"41":{start:{line:91,column:16},end:{line:91,column:105}},"42":{start:{line:92,column:16},end:{line:92,column:41}},"43":{start:{line:93,column:16},end:{line:93,column:28}},"44":{start:{line:97,column:4},end:{line:118,column:7}},"45":{start:{line:98,column:8},end:{line:117,column:11}},"46":{start:{line:99,column:23},end:{line:104,column:13}},"47":{start:{line:105,column:12},end:{line:116,column:15}},"48":{start:{line:111,column:16},end:{line:111,column:69}},"49":{start:{line:112,column:16},end:{line:112,column:70}},"50":{start:{line:113,column:16},end:{line:113,column:74}},"51":{start:{line:114,column:16},end:{line:114,column:76}},"52":{start:{line:115,column:16},end:{line:115,column:28}},"53":{start:{line:119,column:4},end:{line:136,column:7}},"54":{start:{line:120,column:8},end:{line:135,column:11}},"55":{start:{line:121,column:23},end:{line:124,column:13}},"56":{start:{line:125,column:12},end:{line:134,column:15}},"57":{start:{line:131,column:16},end:{line:131,column:69}},"58":{start:{line:132,column:16},end:{line:132,column:64}},"59":{start:{line:133,column:16},end:{line:133,column:28}},"60":{start:{line:137,column:4},end:{line:149,column:7}},"61":{start:{line:138,column:8},end:{line:148,column:11}},"62":{start:{line:139,column:12},end:{line:147,column:15}},"63":{start:{line:144,column:16},end:{line:144,column:69}},"64":{start:{line:145,column:16},end:{line:145,column:61}},"65":{start:{line:146,column:16},end:{line:146,column:28}}},fnMap:{"0":{name:"(anonymous_0)",decl:{start:{line:6,column:33},end:{line:6,column:34}},loc:{start:{line:6,column:45},end:{line:150,column:1}},line:6},"1":{name:"(anonymous_1)",decl:{start:{line:24,column:15},end:{line:24,column:16}},loc:{start:{line:24,column:31},end:{line:36,column:5}},line:24},"2":{name:"(anonymous_2)",decl:{start:{line:27,column:16},end:{line:27,column:17}},loc:{start:{line:27,column:28},end:{line:29,column:9}},line:27},"3":{name:"(anonymous_3)",decl:{start:{line:29,column:16},end:{line:29,column:17}},loc:{start:{line:29,column:32},end:{line:35,column:9}},line:29},"4":{name:"(anonymous_4)",decl:{start:{line:31,column:22},end:{line:31,column:23}},loc:{start:{line:31,column:34},end:{line:34,column:13}},line:31},"5":{name:"(anonymous_5)",decl:{start:{line:37,column:28},end:{line:37,column:29}},loc:{start:{line:37,column:40},end:{line:66,column:5}},line:37},"6":{name:"(anonymous_6)",decl:{start:{line:38,column:34},end:{line:38,column:35}},loc:{start:{line:38,column:50},end:{line:51,column:9}},line:38},"7":{name:"(anonymous_7)",decl:{start:{line:46,column:21},end:{line:46,column:22}},loc:{start:{line:46,column:43},end:{line:50,column:13}},line:46},"8":{name:"(anonymous_8)",decl:{start:{line:52,column:35},end:{line:52,column:36}},loc:{start:{line:52,column:51},end:{line:65,column:9}},line:52},"9":{name:"(anonymous_9)",decl:{start:{line:60,column:21},end:{line:60,column:22}},loc:{start:{line:60,column:43},end:{line:64,column:13}},line:60},"10":{name:"(anonymous_10)",decl:{start:{line:67,column:35},end:{line:67,column:36}},loc:{start:{line:67,column:47},end:{line:81,column:5}},line:67},"11":{name:"(anonymous_11)",decl:{start:{line:68,column:59},end:{line:68,column:60}},loc:{start:{line:68,column:75},end:{line:80,column:9}},line:68},"12":{name:"(anonymous_12)",decl:{start:{line:73,column:21},end:{line:73,column:22}},loc:{start:{line:73,column:43},end:{line:79,column:13}},line:73},"13":{name:"(anonymous_13)",decl:{start:{line:82,column:35},end:{line:82,column:36}},loc:{start:{line:82,column:47},end:{line:96,column:5}},line:82},"14":{name:"(anonymous_14)",decl:{start:{line:83,column:59},end:{line:83,column:60}},loc:{start:{line:83,column:75},end:{line:95,column:9}},line:83},"15":{name:"(anonymous_15)",decl:{start:{line:88,column:21},end:{line:88,column:22}},loc:{start:{line:88,column:43},end:{line:94,column:13}},line:88},"16":{name:"(anonymous_16)",decl:{start:{line:97,column:39},end:{line:97,column:40}},loc:{start:{line:97,column:51},end:{line:118,column:5}},line:97},"17":{name:"(anonymous_17)",decl:{start:{line:98,column:41},end:{line:98,column:42}},loc:{start:{line:98,column:57},end:{line:117,column:9}},line:98},"18":{name:"(anonymous_18)",decl:{start:{line:110,column:21},end:{line:110,column:22}},loc:{start:{line:110,column:43},end:{line:116,column:13}},line:110},"19":{name:"(anonymous_19)",decl:{start:{line:119,column:42},end:{line:119,column:43}},loc:{start:{line:119,column:54},end:{line:136,column:5}},line:119},"20":{name:"(anonymous_20)",decl:{start:{line:120,column:40},end:{line:120,column:41}},loc:{start:{line:120,column:56},end:{line:135,column:9}},line:120},"21":{name:"(anonymous_21)",decl:{start:{line:130,column:21},end:{line:130,column:22}},loc:{start:{line:130,column:43},end:{line:134,column:13}},line:130},"22":{name:"(anonymous_22)",decl:{start:{line:137,column:46},end:{line:137,column:47}},loc:{start:{line:137,column:58},end:{line:149,column:5}},line:137},"23":{name:"(anonymous_23)",decl:{start:{line:138,column:38},end:{line:138,column:39}},loc:{start:{line:138,column:54},end:{line:148,column:9}},line:138},"24":{name:"(anonymous_24)",decl:{start:{line:143,column:21},end:{line:143,column:22}},loc:{start:{line:143,column:43},end:{line:147,column:13}},line:143}},branchMap:{},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0},b:{},_coverageSchema:"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c"},coverage=global[gcv]||(global[gcv]={});if(coverage[path]&&coverage[path].hash===hash){return coverage[path];}coverageData.hash=hash;return coverage[path]=coverageData;}();cov_1bxotiz5jl.s[0]++;Object.defineProperty(exports,"__esModule",{value:true});var HTTPStatus=(cov_1bxotiz5jl.s[1]++,require("http-status"));var jwt=(cov_1bxotiz5jl.s[2]++,require("jwt-simple"));var helpers_1=(cov_1bxotiz5jl.s[3]++,require("./config/helpers"));cov_1bxotiz5jl.s[4]++;describe('Testes de IntegraÃ§Ã£o',function(){'use strict';cov_1bxotiz5jl.f[0]++;var config=(cov_1bxotiz5jl.s[5]++,require('../../server/config/env/config')());var model=(cov_1bxotiz5jl.s[6]++,require('../../server/models'));var id;var token;var userTest=(cov_1bxotiz5jl.s[7]++,{id:100,name:'Usuario Teste',email:'teste@teste.com',password:'teste'});var userDefault=(cov_1bxotiz5jl.s[8]++,{id:1,name:'Kirk',email:'kirk@email.com',password:'123'});cov_1bxotiz5jl.s[9]++;beforeEach(function(done){cov_1bxotiz5jl.f[1]++;cov_1bxotiz5jl.s[10]++;model.User.destroy({where:{}}).then(function(){cov_1bxotiz5jl.f[2]++;cov_1bxotiz5jl.s[11]++;return model.User.create(userDefault);}).then(function(user){cov_1bxotiz5jl.f[3]++;cov_1bxotiz5jl.s[12]++;model.User.create(userTest).then(function(){cov_1bxotiz5jl.f[4]++;cov_1bxotiz5jl.s[13]++;token=jwt.encode({id:user.id},config.secret);cov_1bxotiz5jl.s[14]++;done();});});});cov_1bxotiz5jl.s[15]++;describe('POST /token',function(){cov_1bxotiz5jl.f[5]++;cov_1bxotiz5jl.s[16]++;it('Deve receber um JWT',function(done){cov_1bxotiz5jl.f[6]++;var credentials=(cov_1bxotiz5jl.s[17]++,{email:userDefault.email,password:userDefault.password});cov_1bxotiz5jl.s[18]++;helpers_1.request(helpers_1.app).post('/token').send(credentials).end(function(error,res){cov_1bxotiz5jl.f[7]++;cov_1bxotiz5jl.s[19]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[20]++;helpers_1.expect(res.body.token).to.equal(""+token);cov_1bxotiz5jl.s[21]++;done(error);});});cov_1bxotiz5jl.s[22]++;it('NÃ£o deve gerar Token',function(done){cov_1bxotiz5jl.f[8]++;var credentials=(cov_1bxotiz5jl.s[23]++,{email:'outroemail@email.com.br',password:'email'});cov_1bxotiz5jl.s[24]++;helpers_1.request(helpers_1.app).post('/token').send(credentials).end(function(error,res){cov_1bxotiz5jl.f[9]++;cov_1bxotiz5jl.s[25]++;helpers_1.expect(res.status).to.equal(HTTPStatus.UNAUTHORIZED);cov_1bxotiz5jl.s[26]++;helpers_1.expect(res.body).to.empty;cov_1bxotiz5jl.s[27]++;done(error);});});});cov_1bxotiz5jl.s[28]++;describe('GET /api/users/all',function(){cov_1bxotiz5jl.f[10]++;cov_1bxotiz5jl.s[29]++;it('Deve retornar um Array com todos os Usuarios',function(done){cov_1bxotiz5jl.f[11]++;cov_1bxotiz5jl.s[30]++;helpers_1.request(helpers_1.app).get('/api/users/all').set('Content-Type','application/json').set('Authorization',"JWT "+token).end(function(error,res){cov_1bxotiz5jl.f[12]++;cov_1bxotiz5jl.s[31]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[32]++;helpers_1.expect(res.body.payload).to.be.an('array');cov_1bxotiz5jl.s[33]++;helpers_1.expect(res.body.payload[0].name).to.be.equal(userDefault.name);cov_1bxotiz5jl.s[34]++;helpers_1.expect(res.body.payload[0].email).to.be.equal(userDefault.email);cov_1bxotiz5jl.s[35]++;done(error);});});});cov_1bxotiz5jl.s[36]++;describe('GET /api/users/:id',function(){cov_1bxotiz5jl.f[13]++;cov_1bxotiz5jl.s[37]++;it('Deve retornar um Array com apenas um Usuario',function(done){cov_1bxotiz5jl.f[14]++;cov_1bxotiz5jl.s[38]++;helpers_1.request(helpers_1.app).get("/api/users/"+userDefault.id).set('Content-Type','application/json').set('Authorization',"JWT "+token).end(function(error,res){cov_1bxotiz5jl.f[15]++;cov_1bxotiz5jl.s[39]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[40]++;helpers_1.expect(res.body.payload.id).to.equal(userDefault.id);cov_1bxotiz5jl.s[41]++;helpers_1.expect(res.body.payload).to.have.all.keys(['id','name','email','password']);cov_1bxotiz5jl.s[42]++;id=res.body.payload.id;cov_1bxotiz5jl.s[43]++;done(error);});});});cov_1bxotiz5jl.s[44]++;describe('POST /api/users/create',function(){cov_1bxotiz5jl.f[16]++;cov_1bxotiz5jl.s[45]++;it('Deve criar um novo Usuario',function(done){cov_1bxotiz5jl.f[17]++;var user=(cov_1bxotiz5jl.s[46]++,{id:2,name:'Usuario Teste',email:'usuario@email.com',password:'usuario'});cov_1bxotiz5jl.s[47]++;helpers_1.request(helpers_1.app).post('/api/users/create').set('Content-Type','application/json').set('Authorization',"JWT "+token).send(user).end(function(error,res){cov_1bxotiz5jl.f[18]++;cov_1bxotiz5jl.s[48]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[49]++;helpers_1.expect(res.body.payload.id).to.eql(user.id);cov_1bxotiz5jl.s[50]++;helpers_1.expect(res.body.payload.name).to.eql(user.name);cov_1bxotiz5jl.s[51]++;helpers_1.expect(res.body.payload.email).to.eql(user.email);cov_1bxotiz5jl.s[52]++;done(error);});});});cov_1bxotiz5jl.s[53]++;describe('PUT /api/users/:id/update',function(){cov_1bxotiz5jl.f[19]++;cov_1bxotiz5jl.s[54]++;it('Deve atualizar um Usuario',function(done){cov_1bxotiz5jl.f[20]++;var user=(cov_1bxotiz5jl.s[55]++,{name:'TesteUpdate',email:'update@email.com'});cov_1bxotiz5jl.s[56]++;helpers_1.request(helpers_1.app).put("/api/users/"+userTest.id+"/update").set('Content-Type','application/json').set('Authorization',"JWT "+token).send(user).end(function(error,res){cov_1bxotiz5jl.f[21]++;cov_1bxotiz5jl.s[57]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[58]++;helpers_1.expect(res.body.payload[0]).to.eql(1);cov_1bxotiz5jl.s[59]++;done(error);});});});cov_1bxotiz5jl.s[60]++;describe('DELETE /api/users/:id/destroy',function(){cov_1bxotiz5jl.f[22]++;cov_1bxotiz5jl.s[61]++;it('Deve remover um Usuario',function(done){cov_1bxotiz5jl.f[23]++;cov_1bxotiz5jl.s[62]++;helpers_1.request(helpers_1.app).delete("/api/users/"+userTest.id+"/destroy").set('Content-Type','application/json').set('Authorization',"JWT "+token).end(function(error,res){cov_1bxotiz5jl.f[24]++;cov_1bxotiz5jl.s[63]++;helpers_1.expect(res.status).to.equal(HTTPStatus.OK);cov_1bxotiz5jl.s[64]++;helpers_1.expect(res.body.payload).to.eql(1);cov_1bxotiz5jl.s[65]++;done(error);});});});});